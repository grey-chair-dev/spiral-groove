<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics Testing Tool</title>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            max-width: 800px;
            margin: 40px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #0056b3;
        }
        .status {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
        }
        .success {
            background: #d4edda;
            color: #155724;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
        }
        .info {
            background: #d1ecf1;
            color: #0c5460;
        }
        #events-log {
            max-height: 300px;
            overflow-y: auto;
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
        }
        .event-item {
            padding: 5px;
            margin: 5px 0;
            border-left: 3px solid #007bff;
            padding-left: 10px;
        }
    </style>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7VV4DCV276"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-7VV4DCV276', {
        send_page_view: false
      });
    </script>
</head>
<body>
    <h1>üîç Analytics Testing Tool</h1>
    <p>GA4 Measurement ID: <strong>G-7VV4DCV276</strong></p>

    <div class="test-section">
        <h2>1. Check GA4 Status</h2>
        <button onclick="checkGA4()">Check GA4 Setup</button>
        <div id="ga4-status"></div>
    </div>

    <div class="test-section">
        <h2>2. Test Events</h2>
        <button onclick="testPageView()">Test Pageview</button>
        <button onclick="testProductView()">Test Product View</button>
        <button onclick="testAddToCart()">Test Add to Cart</button>
        <button onclick="testBeginCheckout()">Test Begin Checkout</button>
        <button onclick="testPurchase()">Test Purchase</button>
        <button onclick="testSearch()">Test Search</button>
        <button onclick="testNewsletterSignup()">Test Newsletter Signup</button>
        <button onclick="testSignup()">Test User Signup</button>
        <button onclick="testLogin()">Test Login</button>
    </div>

    <div class="test-section">
        <h2>3. Event Log</h2>
        <button onclick="clearLog()">Clear Log</button>
        <div id="events-log"></div>
    </div>

    <div class="test-section">
        <h2>4. Network Monitor</h2>
        <p>Open DevTools ‚Üí Network tab, filter by "collect" to see GA4 requests</p>
        <p><strong>Tip:</strong> Check the request payload to verify event data</p>
    </div>

    <script>
        function logEvent(eventName, data) {
            const log = document.getElementById('events-log');
            const time = new Date().toLocaleTimeString();
            const eventDiv = document.createElement('div');
            eventDiv.className = 'event-item';
            eventDiv.innerHTML = `<strong>${time}</strong> - ${eventName}<br><pre>${JSON.stringify(data, null, 2)}</pre>`;
            log.insertBefore(eventDiv, log.firstChild);
        }

        function checkGA4() {
            const statusDiv = document.getElementById('ga4-status');
            const hasGtag = typeof window.gtag !== 'undefined';
            const hasDataLayer = Array.isArray(window.dataLayer);
            const dataLayerLength = window.dataLayer?.length || 0;

            if (hasGtag && hasDataLayer) {
                statusDiv.innerHTML = `
                    <div class="status success">
                        ‚úÖ GA4 is loaded correctly!<br>
                        gtag function: ${hasGtag ? '‚úÖ' : '‚ùå'}<br>
                        dataLayer: ${hasDataLayer ? '‚úÖ' : '‚ùå'} (${dataLayerLength} items)
                    </div>
                `;
            } else {
                statusDiv.innerHTML = `
                    <div class="status error">
                        ‚ùå GA4 not loaded properly<br>
                        gtag function: ${hasGtag ? '‚úÖ' : '‚ùå'}<br>
                        dataLayer: ${hasDataLayer ? '‚úÖ' : '‚ùå'}
                    </div>
                `;
            }
        }

        function testPageView() {
            window.gtag('config', 'G-7VV4DCV276', {
                page_path: '/test-page',
                page_title: 'Test Page - Analytics Testing'
            });
            logEvent('page_view', { page_path: '/test-page', page_title: 'Test Page' });
        }

        function testProductView() {
            window.gtag('event', 'view_item', {
                currency: 'USD',
                value: 25.99,
                items: [{
                    item_id: 'test-product-123',
                    item_name: 'Test Vinyl Record',
                    item_category: 'Vinyl',
                    item_brand: 'Spiral Groove Records',
                    price: 25.99,
                    quantity: 1
                }]
            });
            logEvent('view_item', { product: 'Test Vinyl Record', price: 25.99 });
        }

        function testAddToCart() {
            window.gtag('event', 'add_to_cart', {
                currency: 'USD',
                value: 25.99,
                items: [{
                    item_id: 'test-product-123',
                    item_name: 'Test Vinyl Record',
                    item_category: 'Vinyl',
                    item_brand: 'Spiral Groove Records',
                    price: 25.99,
                    quantity: 1
                }]
            });
            logEvent('add_to_cart', { product: 'Test Vinyl Record', price: 25.99 });
        }

        function testBeginCheckout() {
            window.gtag('event', 'begin_checkout', {
                currency: 'USD',
                value: 50.98,
                items: [
                    {
                        item_id: 'test-product-123',
                        item_name: 'Test Vinyl Record',
                        item_category: 'Vinyl',
                        price: 25.99,
                        quantity: 1
                    },
                    {
                        item_id: 'test-product-456',
                        item_name: 'Test CD',
                        item_category: 'CD',
                        price: 24.99,
                        quantity: 1
                    }
                ]
            });
            logEvent('begin_checkout', { value: 50.98, items: 2 });
        }

        function testPurchase() {
            window.gtag('event', 'purchase', {
                transaction_id: 'test-order-' + Date.now(),
                value: 50.98,
                tax: 4.08,
                shipping: 0,
                currency: 'USD',
                items: [
                    {
                        item_id: 'test-product-123',
                        item_name: 'Test Vinyl Record',
                        item_category: 'Vinyl',
                        price: 25.99,
                        quantity: 1
                    },
                    {
                        item_id: 'test-product-456',
                        item_name: 'Test CD',
                        item_category: 'CD',
                        price: 24.99,
                        quantity: 1
                    }
                ]
            });
            logEvent('purchase', { transaction_id: 'test-order', value: 50.98 });
        }

        function testSearch() {
            window.gtag('event', 'search', {
                search_term: 'test search query'
            });
            logEvent('search', { search_term: 'test search query' });
        }

        function testNewsletterSignup() {
            window.gtag('event', 'newsletter_signup', {
                source: 'test-tool'
            });
            logEvent('newsletter_signup', { source: 'test-tool' });
        }

        function testSignup() {
            window.gtag('event', 'sign_up', {
                method: 'email'
            });
            logEvent('sign_up', { method: 'email' });
        }

        function testLogin() {
            window.gtag('event', 'login', {
                method: 'email'
            });
            logEvent('login', { method: 'email' });
        }

        function clearLog() {
            document.getElementById('events-log').innerHTML = '';
        }

        // Auto-check on load
        window.addEventListener('load', () => {
            setTimeout(checkGA4, 1000);
        });

        // Monitor dataLayer changes
        const originalPush = window.dataLayer.push;
        window.dataLayer.push = function(...args) {
            const result = originalPush.apply(this, args);
            if (args[0] === 'event' || args[0] === 'config') {
                console.log('[Analytics] Event sent:', args);
            }
            return result;
        };
    </script>
</body>
</html>
